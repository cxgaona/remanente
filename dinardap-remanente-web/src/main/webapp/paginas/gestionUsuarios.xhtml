<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui">
    <ui:composition template="/template/general.xhtml">
        <ui:define name="content">        
            <h1 class="h-wai">#{etiquetas['nombre.sistema']} - #{gestionUsuariosCtrl.tituloPagina}</h1>
            
            <h:form id="formUsuario">                
                <b:panel title="Usuarios Activos">
                    <h:panelGrid columns="1" style="width: 100%;">

                        <p:dataTable id="usuarioTbl"
                                     value="#{gestionUsuariosCtrl.usuarioDtoList}" 
                                     var="usuarioDto"
                                     rowKey="#{usuarioDto.usuario.usuarioId}"                                     
                                     reflow="true" rows="5" paginator="true"                                     
                                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     rowsPerPageTemplate="5,10,25,50"
                                     tableStyle="width:auto">                            
                            <p:column headerText="Nombre" sortBy="#{usuarioDto.usuario.nombre}" filterBy="#{usuarioDto.usuario.nombre}" filterMatchMode="contains">
                                <h:outputText value="#{usuarioDto.usuario.nombre}" />
                            </p:column>
                            <p:column headerText="Cédula" sortBy="#{usuarioDto.usuario.cedula}" filterBy="#{usuarioDto.usuario.cedula}" filterMatchMode="contains">
                                <h:outputText value="#{usuarioDto.usuario.cedula}" />
                            </p:column>
                            <p:column headerText="Institución" sortBy="#{usuarioDto.institucion.nombre}" filterBy="#{usuarioDto.institucion.nombre}" filterMatchMode="contains" >
                                <h:outputText value="#{usuarioDto.institucion.nombre}"/>
                            </p:column>
                            <p:column headerText="Provincia - Cantón" sortBy="#{usuarioDto.institucion.canton.provincia.nombre} - #{usuarioDto.institucion.canton.nombre}" filterBy="#{usuarioDto.institucion.canton.provincia.nombre} - #{usuarioDto.institucion.canton.nombre}" filterMatchMode="contains" >
                                <h:outputText value="#{usuarioDto.institucion.canton.provincia.nombre} - #{usuarioDto.institucion.canton.nombre}"/>
                            </p:column>
                            <p:column headerText="Dirección Regional" sortBy="#{usuarioDto.institucion.tipoInstitucion.tipoInstitucionId eq 4 or 
                                                                                usuarioDto.institucion.tipoInstitucion.tipoInstitucionId eq 3 ?usuarioDto.institucion.institucion.nombre: 
                                                                                usuarioDto.institucion.tipoInstitucion.tipoInstitucionId eq 2 ?usuarioDto.institucion.nombre:
                                                                                usuarioDto.institucion.institucion.institucion.nombre}" 
                                      filterBy="#{usuarioDto.institucion.tipoInstitucion.tipoInstitucionId eq 4 or 
                                                  usuarioDto.institucion.tipoInstitucion.tipoInstitucionId eq 3 ?usuarioDto.institucion.institucion.nombre: 
                                                  usuarioDto.institucion.tipoInstitucion.tipoInstitucionId eq 2 ?usuarioDto.institucion.nombre:
                                                  usuarioDto.institucion.institucion.institucion.nombre}" filterMatchMode="contains" >
                                <h:outputText value="#{usuarioDto.institucion.tipoInstitucion.tipoInstitucionId eq 4 or 
                                                       usuarioDto.institucion.tipoInstitucion.tipoInstitucionId eq 3 ?usuarioDto.institucion.institucion.nombre: 
                                                       usuarioDto.institucion.tipoInstitucion.tipoInstitucionId eq 2 ?usuarioDto.institucion.nombre:
                                                       usuarioDto.institucion.institucion.institucion.nombre}"/>
                            </p:column>
                            <p:column headerText="Tipo Institución" 
                                      sortBy="#{usuarioDto.institucion.tipoInstitucion.descripcion}" 
                                      filterBy="#{usuarioDto.institucion.tipoInstitucion.descripcion}" 
                                      filterMatchMode="contains">
                                <h:outputText value="#{usuarioDto.institucion.tipoInstitucion.descripcion}"/>
                            </p:column>
                            <p:column headerText="Perfil" 
                                      sortBy="#{usuarioDto.perfil}" 
                                      filterBy="#{usuarioDto.perfil}" 
                                      filterMatchMode="contains">
                                <h:outputText value="#{usuarioDto.perfil}"/>
                            </p:column>
                        </p:dataTable>                          
                    </h:panelGrid>

                    <b:panelGrid id="usuarioPnl" colSpans="6,6" style="width: 40%; margin: 4px 5px;">
                        <p:commandButton value="Actualizar"
                                         style="margin-right:20px;" 
                                         action="#{gestionUsuariosCtrl.nuevoUsuario}"
                                         icon="fa fa-fw fa-refresh"/>
                    </b:panelGrid>
                </b:panel>
            </h:form>
        </ui:define>
    </ui:composition>
</html>
